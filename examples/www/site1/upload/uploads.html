<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/carbon-components/10.58.12/css/carbon-components.min.css">
  <title>Uploads</title>
  <style>

    :root
    {
      --cor-primaria: #4f46e5;
      --cor-fundo: #0e1529;
      --cor-texto: #e5e7eb;
      --cor-texto-sec: #cbd5e1;
      --bordas: rgba(255,255,255,0.1);
    }

    *
    {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body
    {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: #f3f4f6;
      color: #111;
      line-height: 1.6;
    }

    .navbar
    {
      background: var(--cor-fundo);
      color: #fff;
      border-bottom: 1px solid var(--bordas);
    }

    .container
    {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .nav
    {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 70px;
    }

    .logo
    {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      color: #fff;
      font-weight: 700;
      font-size: 25px;
    }

    .menu
    {
      display: flex;
      list-style: none;
      gap: 1rem;
    }

    .menu a
    {
      color: var(--cor-texto);
      text-decoration: none;
      font-size: 18px;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
    }

    .menu a:hover
    {
      background: rgba(255,255,255,0.08);
    }

    .menu a.active
    {
      background: rgba(79,70,229,0.25);
      color: #fff;
      border: 1px solid rgba(99,102,241,0.6);
    }

    main
    {
      padding: 2rem 1rem;
    }

    .hero
    {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 2rem;
      align-items: center;
      justify-content: center;
      margin-top: 45px;
      margin-bottom: 40px;
    }

    .hero
    {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .hero-text
    {
      max-width: 500px;
      margin-top: 100px;
      margin-bottom: 150px;
    }

    .grid
    {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    img
    {
        width: 180px;
        height: 150px
    }

    .item
    {
      background-color: #272d3d;
      color: var(--cor-texto);
      padding: 40px 25px;
      border-radius: 2px;
    }

    .item:hover
    {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
    }

    .item h3
    {
      margin-bottom: 10px;
      color: var(--cor-primaria);
    }

    .foot
    {
        width: 100%;
        height: 120px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
        margin-top: 150px;
        background: var(--cor-fundo);
        color: var(--cor-texto);
        gap: 8px;
    }

    .last
    {
        display: flex;
        margin-top: 150px;
        justify-content: center;
        flex-direction: row;
        gap: 50px;
        width: 100%;
    }

    #uploadButton
    {
        padding: 12px 60px;
        border-radius: 15px;
        border: 0px;
        color: white;
        background-color: #0e1529;
        font-size: 20px;
    }

    #uploadButton:hover
    {
        cursor: pointer;
        background-color: var(--cor-primaria);
        color: #fff;
        transition: 0.3s;
    }

    .file-item {
    background: #ffffff;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    color: #111;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    position: relative;
}

.file-item img, .file-item video
{
    width: 100%;
    height: auto;
    border-radius: 6px;
}

.delete-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: #dc2626;
    color: white;
    border: none;
    font-size: 14px;
    padding: 6px 10px;
    border-radius: 6px;
    cursor: pointer;
}

.delete-btn:hover {
    background: #b91c1c;
}


    @media (max-width: 768px)
    {
      .nav
      {
        flex-direction: column;
        height: auto;
        padding: 1rem 0;
      }

      .menu
      {
        margin-top: 20px;
        flex-direction: column;
        align-items: center;
      }

      .hero
      {
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      
      img
      {
        width: 140px;
        height: 100px
      }
      
      #uploadButton
      {
          padding: 9px 35px;
          border-radius: 15px;
          border: 0px;
          color: white;
          background-color: #373d4d;
          font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <header class="navbar">
    <div class="container nav">
      <a href="../index.html" class="logo">
          <img src="../3u-server-svgrepo-com.png" alt="svServer" style="width: 32px; height: 28px;">
        <span>MasterServer</span>
      </a>
      <nav aria-label="Menu principal">
        <ul class="menu">
          <li id="inicio"><a href="#" >Início</a></li>
          <li id="serviços"><a href="#">Serviços</a></li>
          <li id="uploads" ><a href="#" class='active'>Uploads</a></li>
          <li id="sessions"><a href="#">Sessões</a></li>
          <li id="sobre"><a href="#">Sobre</a></li>
          <li id="contato"><a href="#">Contato</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="hero">
        <div>
            <h1 style="line-height: 1.1; font-size: 30px;font-weight: 500;">Uploads</h1>
            <p style="font-size: 20px; line-height: 1.3; margin-top: 10px;">
                Faça upload de seus arquivos de forma rápida e segura com nosso sistema intuitivo. Selecione os arquivos desejados e clique no botão para iniciar o processo de upload. Aproveite a facilidade de gerenciar seus arquivos diretamente em nosso servidor.
            </p>
        </div>
        <div style="width: 100%;display: flex;flex-direction: column;justify-content: center; align-items: center;text-align: center;">
          <h2 style="margin-top: 50px; margin-bottom: 20px;">Arquivos enviados</h2>
          <div id="filesGrid" class="grid" style="width: 100%;">
          </div>
          <div style="display:flex; flex-direction: column; gap: 10px;margin: 50px 0;justify-content: center; align-items: center;">
            <img src="./uploadImg4.png" alt="Imagem ilustrativa de upload de arquivos" />
            <button id="uploadButton">Fazer upload</button>
        </div>
        </div>
    </div>

    <section class="last">
        <svg width="48" height="48" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" aria-label="Google-inspired icon">
            <defs>
                <linearGradient id="ggrad" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0%" stop-color="#4285F4"/>
                <stop offset="50%" stop-color="#34A853"/>
                <stop offset="100%" stop-color="#FBBC05"/>
                </linearGradient>
            </defs>
            <circle cx="24" cy="24" r="22" fill="url(#ggrad)" stroke="#fff" stroke-width="2"/>
            <path d="M16 28h6v6h-6z" fill="#fff" opacity="0.85"/>
            <path d="M26 16h6v6h-6z" fill="#fff" opacity="0.85"/>
        </svg>

        <svg width="48" height="48" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-label="GitHub-inspired icon" fill="currentColor">
            <path d="M12 .5a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58v-2.04c-3.34.73-4.04-1.44-4.04-1.44-.55-1.38-1.34-1.75-1.34-1.75-1.09-.75.08-.74.08-.74 1.2.08 1.83 1.24 1.83 1.24 1.07 1.83 2.8 1.3 3.49.99.1-.77.42-1.3.76-1.6-2.66-.3-5.46-1.33-5.46-5.94 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.17 0 0 1 .32 3.3 1.23A11.5 11.5 0 0 1 12 6.8c.99-.01 1.99.14 2.92.42 2.3-.91 3.3-1.23 3.3-1.23.66 1.65.24 2.87.12 3.17.77.84 1.23 1.91 1.23 3.22 0 4.62-2.8 5.63-5.47 5.93.43.37.82 1.1.82 2.22v3.29c0 .32.22.69.83.58A12 12 0 0 0 12 .5z"/>
        </svg>

        <svg width="48" height="48" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-label="Nginx-inspired icon" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M32 6l22 8v14c0 7-4 12-10 16l-12 6-12-6C14 40 10 35 10 28V14L32 6z" fill="none" stroke="currentColor" />
            <path d="M24 26h16v10H24z" fill="currentColor"/>
            <path d="M28 22h8" stroke="white" stroke-width="2" />
        </svg>

        <svg width="48" height="48" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-label="Docker-inspired icon" fill="currentColor">
            <rect x="6" y="20" width="52" height="28" rx="6" ry="6" fill="currentColor"/>
            <circle cx="22" cy="34" r="4" fill="#fff"/>
            <circle cx="32" cy="34" r="4" fill="#fff"/>
            <circle cx="42" cy="34" r="4" fill="#fff"/>
            <path d="M6 20h52" stroke="#fff" stroke-width="2" />
            <path d="M14 18h6" stroke="#fff" stroke-width="2" />
        </svg>
    </section>
  </main>
  <footer class="foot">
        <p>All rights reserved.</p>
        <p>© 2025 WebServ Team</p>
  </footer>
  <!-- Modal de Upload -->
<div id="uploadModal" style="
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px);
    justify-content: center;
    align-items: center;
    z-index: 9999;">
  
  <div style="
      background: #ffffff;
      width: 90%;
      max-width: 420px;
      border-radius: 12px;
      padding: 25px;
      position: relative;
      box-shadow: 0px 0px 40px rgba(0,0,0,0.25);">

    <!-- Botão fechar -->
    <button id="closeModalBtn" style="
        position: absolute;
        right: 15px;
        top: 12px;
        border: none;
        background: none;
        font-size: 24px;
        cursor: pointer;
        color: #444;">
      ×
    </button>

    <h2 style="margin-bottom: 10px; color:#111;">Enviar Arquivo</h2>
    <p style="margin-bottom: 20px; color:#444;">
      Escolha um arquivo e envie para o servidor.
    </p>

    <!-- FORM REAL DE UPLOAD -->
    <form action="/upload-file" method="POST" enctype="multipart/form-data">
      <input type="file" name="file" required style="
          display: block;
          width: 100%;
          margin-bottom: 15px;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 6px;">
      
      <button type="submit" style="
          width: 100%;
          padding: 12px;
          background: #4f46e5;
          color: white;
          border: none;
          border-radius: 6px;
          font-size: 17px;
          cursor: pointer;">
        Enviar
      </button>
    </form>

  </div>
</div>
<script>
  const modal = document.getElementById("uploadModal");
  const openBtn = document.getElementById("uploadButton");
  const closeBtn = document.getElementById("closeModalBtn");

  openBtn.onclick = () => {
    modal.style.display = "flex";
  };

  closeBtn.onclick = () => {
    modal.style.display = "none";
  };

  window.onclick = (e) => {
    if (e.target === modal) {
      modal.style.display = "none";
    }
  };

  document.querySelectorAll('.menu li').forEach(item => {
    item.addEventListener('click', event => {
        document.querySelectorAll('.menu li a').forEach(link => {
            link.classList.remove('active');
        });
        item.querySelector('a').classList.add('active');
        if (item.id == 'inicio') {
            window.location.href = './index.html';
        } else if (item.id == 'serviços') {
            window.location.href = './servicos/index.html';
        } else if (item.id == 'uploads') {
            window.location.href = './uploads.html';
        } else if (item.id == 'sobre') {
            window.location.href = './about.html';
        } else if (item.id == 'contato') {
            window.location.href = './contact.html';
        }
        else if (item.id == 'sessions') {
            window.location.href = './sessions.html';
        }
    });
});

async function  loadFiles()
{
    const grid = document.getElementById("filesGrid");
    grid.innerHTML = "<p>Carregando arquivos...</p>";

    try
    {
        const res = await fetch("/uploads-list");
        const data = await res.json();

        grid.innerHTML = ""; // limpar

        if (!data.files.length) {
            grid.innerHTML = "<p>Nenhum arquivo enviado ainda.</p>";
            return;
        }

        data.files.forEach(name => {
            const ext = name.split('.').pop().toLowerCase();
            const src = "/uploads/" + name;
            const item = document.createElement("div");
            item.className = "file-item";

            // escolher visualização
            let preview = "";

            if (["png", "jpg", "jpeg", "gif", "webp"].includes(ext)) {
                preview = `<img src="${src}" alt="${name}">`;
            }
            else if (["mp4", "webm"].includes(ext)) {
                preview = `<video src="${src}" controls></video>`;
            }
            else {
                preview = `<p>${name}</p>`;
            }

            item.innerHTML = `
                ${preview}
                <button class="delete-btn" onclick="deleteFile('${name}')">Excluir</button>
            `;

            grid.appendChild(item);
        });

    } catch (err) {
        grid.innerHTML = "<p>Erro ao carregar arquivos.</p>";
        console.error(err);
    }
}

// ==== 2. Deletar arquivo ====
async function deleteFile(filename) {
    if (!confirm("Deseja realmente apagar " + filename + "?"))
        return;

    try {
        const res = await fetch(`/delete-file?name=${filename}`, { method: "DELETE" });

        if (res.status === 200)
        {
            alert("Arquivo deletado!");
            loadFiles(); // recarregar grid
        }
         else
            alert("Erro ao deletar o arquivo!");
    }
    catch (err)
    {
        alert("Erro ao deletar.");
        console.error(err);
    }
}

// carregar ao entrar na página
loadFiles();
</script>
</body>
</html>
